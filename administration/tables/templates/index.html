{% load booking_tags %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Tables</title>
        <link rel="stylesheet" href="{% static 'styles.css' %}">
    </head>
    <body> 
        <nav class="navigation">
            <h1>Tables</h1>

            <div style="margin-left: 20px; display: inline-block;">
                <a href="">Add</a>
                <a href="">Change</a>
                <a href="">Delete</a>
            </div>
        </nav>

        <div style="overflow-x: auto; width: 100vw;">
    <table>
        <thead>
            <tr>
                <th colspan="32" style="text-align: left;">August</th>
            </tr>
            <tr>
                <th>Room Number</th>
                <!-- Days 1-31 -->
                <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th>
                <th>6</th><th>7</th><th>8</th><th>9</th><th>10</th>
                <th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>
                <th>16</th><th>17</th><th>18</th><th>19</th><th>20</th>
                <th>21</th><th>22</th><th>23</th><th>24</th><th>25</th>
                <th>26</th><th>27</th><th>28</th><th>29</th><th>30</th>
                <th>31</th>
            </tr>
        </thead>
        <tbody>
    {% for room in rooms %}
    <tr>
        <td>Room {{ room.room_number }}</td>
        {% for day in 31|times %}
            {% with current_day=day|add:1 %}
                {% for booking in bookings %}
                    {% if booking.room.id == room.id %}
                        {% if current_day >= booking.check_in_date.day and current_day <= booking.check_out_date.day %}
                            {% if current_day == booking.check_in_date.day %}
                                <td colspan="{{ booking.check_out_date.day|subtract:booking.check_in_date.day|add:1 }}" 
                                    style="background-color: #e3f2fd; border-left: 2px solid #2196f3; border-right: 2px solid #2196f3;">
                                    {{ booking.guest_name }}
                                </td>
                            {% endif %}
                        {% else %}
                            {% if forloop.last %} {# Only show empty if no booking matches #}
                                <td></td>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                {% empty %}
                    <td></td>
                {% endfor %}
            {% endwith %}
        {% endfor %}
    </tr>
    {% endfor %}
</tbody>
    </table>
</div>
    </body>
</html>